<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ù†Ø¸Ø§Ù… ÙƒØ±Ø§Ø¬ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      direction: rtl;
      text-align: center;
      margin-top: 40px;
    }
    input, button {
      padding: 10px;
      margin: 5px;
      font-size: 16px;
    }
    h1 {
      font-size: 50px;
    }
  </style>
</head>
<body>

  <h2>ðŸš— Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª Ø¯Ø§Ø®Ù„ Ø§Ù„ÙƒØ±Ø§Ø¬:</h2>
  <h1 id="count">0</h1>

  <h2>ðŸ’° Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø£Ø¬ÙˆØ±:</h2>
  <h1 id="totalFee">0</h1>

  <button onclick="showForm()">âž• Ø¯Ø®ÙˆÙ„ Ø³ÙŠØ§Ø±Ø©</button>
  <button onclick="removeCar()">âž– Ø®Ø±ÙˆØ¬ Ø³ÙŠØ§Ø±Ø©</button>

  <div id="formContainer" style="display:none;">
    <h3>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</h3>
    <input id="carNumber" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø³ÙŠØ§Ø±Ø©"><br>
    <input id="color" placeholder="Ù„ÙˆÙ† Ø§Ù„Ø³ÙŠØ§Ø±Ø©"><br>
    <input id="fee" placeholder="Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£Ø¬Ø±Ø©"><br>
    <input id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ"><br>
    <button onclick="submitCar()">ØªØ³Ø¬ÙŠÙ„</button>
  </div>

  <script>
    // ðŸ”» Ø§Ù†Ø³Ø® Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Firebase Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ Ù‡Ù†Ø§ Ù…Ù† ØµÙØ­Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ðŸ”»
   const firebaseConfig = {
  apiKey: "AIzaSyC7EVNCSl48CQgIC_a8wdC5UG2tKLtNKjQ",
  authDomain: "garag-system.firebaseapp.com",
  databaseURL: "https://garag-system-default-rtdb.firebaseio.com",
  projectId: "garag-system",
  storageBucket: "garag-system.firebasestorage.app",
  messagingSenderId: "330947022055",
  appId: "1:330947022055:web:d0c9d378e200c7de45a642"
};


    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const countRef = db.ref("carCount");
    const totalFeeRef = db.ref("totalFee");

    countRef.on("value", (snapshot) => {
      document.getElementById("count").textContent = snapshot.val() ?? 0;
    });

    totalFeeRef.on("value", (snapshot) => {
      document.getElementById("totalFee").textContent = snapshot.val() ?? 0;
    });

    function getTodayDate() {
      const today = new Date();
      return today.toISOString().split('T')[0];
    }

    function showForm() {
      document.getElementById("formContainer").style.display = "block";
    }

    function submitCar() {
      const today = getTodayDate();
      const carNumber = document.getElementById("carNumber").value;
      const color = document.getElementById("color").value;
      const fee = document.getElementById("fee").value;
      const phone = document.getElementById("phone").value;

      const newCar = {
        carNumber: carNumber || null,
        color: color || null,
        fee: fee || null,
        phone: phone || null,
        timestamp: new Date().toISOString()
      };

      const historyRef = db.ref("history/" + today).push();
      historyRef.set(newCar);
      countRef.transaction(current => (current || 0) + 1);

      if (fee) {
        totalFeeRef.transaction(current => (current || 0) + parseInt(fee));
      }

      document.getElementById("formContainer").style.display = "none";
      document.getElementById("carNumber").value = "";
      document.getElementById("color").value = "";
      document.getElementById("fee").value = "";
      document.getElementById("phone").value = "";
    }

    function removeCar() {
      countRef.transaction(current => Math.max((current || 0) - 1, 0));
    }
  </script>
</body>
</html>
